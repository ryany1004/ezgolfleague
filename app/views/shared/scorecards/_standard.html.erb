<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th width="50%">Flight</th>
      <th width="50%">Course Handicap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><%= primary_scorecard.tournament.flight_for_player(primary_scorecard.golf_outing.user).flight_number %></td>
      <td><%= primary_scorecard.golf_outing.user.course_handicap(primary_scorecard.tournament.course, primary_scorecard.golf_outing.course_tee_box) %></td>
    </tr>
  </tbody>
</table>

<table class="table table-striped table-bordered">
	<thead>
		<tr>
      <th width="5%">Hole</th>
      <% primary_scorecard.scores.each_slice(primary_scorecard.tournament.course_holes.count / 2).to_a.each_with_index do |split, j| %>
        <% split.each do |score| -%>
        <th width="<%= 70 / primary_scorecard.scores.count %>%"><%= score.course_hole.hole_number %></th>
        <% end -%>
        <th width="5%">&nbsp;</th>
      <% end -%>
      <th width="5%">Totals</th>
		</tr>
	</thead>
	<tbody>
    <% other_scorecards.insert(0, primary_scorecard).each do |scorecard| -%>
      <tr>
        <% if scorecard.should_highlight? -%>
          <td><em><%= scorecard.name %></em></td>
        <% else -%>
          <td><%= scorecard.name %></td>
        <% end -%>
        <% scorecard.scores.each_slice(primary_scorecard.tournament.course_holes.count / 2).to_a.each_with_index do |split, j| %>
          <% split.each do |score| -%>
            <% if handicap_allowance_strokes_for_hole(handicap_allowance_for_scorecard(scorecard), score.course_hole) > 0 -%>
            <td style="background-color: #30B82E;"><em><%= link_to_unless !primary_scorecard.tournament.user_can_edit_scorecard(current_user, scorecard), "#{score.strokes}", "#", {"data-toggle" => "modal", "data-target" => "#Group#{score.id}"} %> (-<%=  handicap_allowance_strokes_for_hole(handicap_allowance_for_scorecard(scorecard), score.course_hole) %>)</em></td>
            <% else -%>
            <td><%= link_to_unless !primary_scorecard.tournament.user_can_edit_scorecard(current_user, scorecard), "#{score.strokes}", "#", {"data-toggle" => "modal", "data-target" => "#Group#{score.id}"} %></td>
            <% end -%>
          <% end -%>
          <td><strong><%= split.map {|score| score.strokes }.sum %></strong></td>
        <% end -%>
        <td><strong><%= scorecard.scores.map {|score| score.strokes }.sum %> (<%= scorecard.net_score %>)</strong></td>
      </tr>
    <% end -%>
	</tbody>
  <tfoot>
		<tr>
			<th>Par</th>
      <% primary_scorecard.scores.each_slice(primary_scorecard.tournament.course_holes.count / 2).to_a.each_with_index do |split, j| %>
        <% split.each do |score| -%>
          <th><%= score.course_hole.par %></th>
        <% end -%>
        <th>&nbsp;</th>
      <% end -%>
      <th><%= primary_scorecard.tournament.course_holes.map {|hole| hole.par }.sum %></th>
		</tr>
		<tr>
			<th>Men's Handicap</th>
      <% primary_scorecard.scores.each_slice(primary_scorecard.tournament.course_holes.count / 2).to_a.each_with_index do |split, j| %>
        <% split.each do |score| -%>      
          <th><%= score.course_hole.mens_handicap %></th>
        <% end -%>
        <th>&nbsp;</th>
      <% end -%>
      <th>&nbsp;</th>
		</tr>
		<tr>
			<th>Women's Handicap</th>
      <% primary_scorecard.scores.each_slice(primary_scorecard.tournament.course_holes.count / 2).to_a.each_with_index do |split, j| %>
        <% split.each do |score| -%>      
          <th><%= score.course_hole.mens_handicap %></th>
        <% end -%>
        <th>&nbsp;</th>
      <% end -%>
      <th>&nbsp;</th>
		</tr>
  </tfoot>
</table>

<% if primary_scorecard.tournament.user_can_edit_scorecard(current_user, primary_scorecard) == true && primary_scorecard.tournament.is_finalized == false -%>
  <p><%= link_to 'Finalize Your Scorecard', play_scorecard_finalize_scorecard_path(primary_scorecard), :class => 'btn btn-danger', :method => :patch, :data => { :confirm => 'Are you sure you want to finalize your scorecard? This indicates to the league administrator that you are ready to be ranked for this tournament.' } %></p>
<% end -%>

<% other_scorecards.insert(0, primary_scorecard).each do |scorecard| %>
  <% if primary_scorecard.tournament.user_can_edit_scorecard(current_user, scorecard) -%>
    <% scorecard.scores.each do |score| -%>
      <%= render partial: '/shared/scorecards/standard_edit_modal', locals: {score: score, edit_url: play_scorecard_update_score_path(primary_scorecard, score_id: score.id)} %>
    <% end -%>
  <% end -%>
<% end -%>