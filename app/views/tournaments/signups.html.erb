<h4><%= @page_title %></h4>

<table class="table table-striped">
	<thead>
		<tr>
			<th>Name</th>
      <th>Group / Tee Time</th>
      <th>Flight</th>
      <% if is_editable?(@tournament) -%>
      <th><button type="button" class="btn btn-primary btn" data-toggle="modal" data-target="#GroupSignup">Signup for Tournament</button></th>
      <% else -%>
      <th>&nbsp;</th>
      <% end -%>
		</tr>
	</thead>
	<tbody>
	<% @tournament_groups.each_with_index do |tournament_group, i| %>
    <% tournament_group.teams.each do |team| %>
      <% team.golf_outings.each do |golf_outing| %>
      <tr>
        <td><%= golf_outing.user.complete_name %></td>
        <td>#<%= i + 1 %> - <%= tournament_group.tee_time_at.to_s(:date_and_time) %></td>
        <td><%= @tournament.flight_for_player(golf_outing.user).flight_number %></td>
        <% if user_is_league_admin(current_user, @tournament.league) && is_editable?(@tournament) -%>
        <td><%= link_to "Delete Registration", league_tournament_delete_signup_path(@tournament.league, @tournament, group_id: tournament_group.id, user_id: golf_outing.user), :data => { :confirm => 'Are you sure you want to delete this registration?' }, :method => :delete %></td>
        <% else -%>
        <td>&nbsp;</td>
        <% end -%>
      </tr>
      <% end %>
    <% end %>
	<% end %>
	</tbody>
  <tfoot>
		<tr>
      <th>&nbsp;</th>
			<th>&nbsp;</th>
      <th>&nbsp;</th>
      <th>&nbsp;</th>
		</tr>
  </tfoot>
</table>

<%= paginate @tournament_groups %>

<%= simple_form_for :tournament_group_signup, url: league_tournament_add_signup_path(@tournament.league, @tournament), method: :post do |f| %>
<div class="modal fade" id="GroupSignup" role="dialog" aria-labelledby="gridSystemModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="gridSystemModalLabel">Register for Tournament</h4>
        </div>
        <div class="modal-body">
          <div class="container-fluid">
            <div class="row">
              <div class="well">
                <p>Add a user to this tournament:</p>
                <%= f.input :tee_group, label: "Available Tee Groups", collection: @available_tournament_groups, label_method: :formatted_tee_time, value_method: :id %>
                <%= f.input :another_member_id, label: "Unregistered League Members", collection: @unregistered_users, label_method: :complete_name, value_method: :id %>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <%= f.button :button, "Register", :class => "btn btn-default", :value => true %>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<% end %>