<ol class="breadcrumb">
  <li><%= link_to "Leagues", leagues_path %></li>
  <li class="active">League Memberships</li>
</ol>

<h4>League Membership</h4>

<div class="row">
  <div class="col-md-10">&nbsp;</div>
  <div class="col-md-2">
    <p><%= link_to "Print Members", print_league_league_memberships_path(@league), class: "btn btn-info", role: "button", target: "_blank" %></p>
  </div>
</div>

<%= simple_form_for :update_active, url: update_active_league_league_memberships_path(@league), method: :put do |f| %>
  <table class="table table-striped">
  	<thead>
  		<tr>
        <th>Active for Billing</th>
  			<th>Name</th>
        <th>Balance</th>
        <th>Admin</th>
        <th>Added</th>
        <th>GHIN Updated</th>
        <th><%= link_to 'Create Membership', new_league_league_membership_path(@league), :class => 'btn btn-primary' %></th>
  		</tr>
  	</thead>
  	<tbody>
  	<% @league_memberships.each do |membership| %>
  		<tr>
        <td><%= check_box_tag "is_active[#{membership.id}]", true, membership.state == MembershipStates::ACTIVE_FOR_BILLING %></td>
  			<td><%= link_to membership.user.complete_name, edit_league_league_membership_path(@league, membership) %></td>
        <td><%= number_to_currency(membership.user.payments_for_league(membership.league).map(&:payment_amount).inject(0, &:+)) %></td>
        <td><%= human_boolean(membership.is_admin?) %></td>
  			<td><%= membership.created_at.to_s(:date_and_time) %></td>
        <td><%= membership.user.ghin_updated_at.to_s(:date_and_time) unless membership.user.ghin_updated_at.blank? %></td>
        <td><%= link_to "Edit", edit_league_league_membership_path(@league, membership) %> | <%= link_to 'Delete', league_league_membership_path(@league, membership), :data => { :confirm => 'Are you sure you want to delete this membership?' }, :method => :delete %></td>
  		</tr>
  	<% end %>
  	</tbody>
    <tfoot>
  		<tr>
        <th><%= f.button :submit, "Save Active Status", :class => 'btn btn-default' %></th>
  			<th>&nbsp;</th>
        <th>&nbsp;</th>
        <th>&nbsp;</th>
        <th>&nbsp;</th>
  			<th>&nbsp;</th>
        <th><%= link_to 'Create Membership', new_league_league_membership_path(@league), :class => 'btn btn-primary' %></th>
  		</tr>
    </tfoot>
  </table>
<% end %>

<%= paginate @league_memberships %>
