<ol class="breadcrumb">
  <li><%= link_to "Tournaments", league_tournaments_path(current_user.selected_league) %></li>
  <li><%= link_to @tournament.name, edit_league_tournament_path(current_user.selected_league, @tournament) %></li>
  <li class="active">Manage Game Types <%= @tournament_day.pretty_day(true) %></li>
</ol>

<%= render partial: '/shared/tournaments/manage', locals: {tournament: @tournament, stage: @stage_name} %>

<h4><%= @page_title %></h4>

<div class="col-md-12">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Game Types</h3>
    </div>
    <div class="panel-body">
    	The primary game type determines how scorecards appear and how handicaps are displayed.
    </div>
		<table class="table table-striped">
		  <thead>
		    <tr>
		    	<th>Primary Type</th>
		      <th>Name</th>
		      <th>&nbsp;</th>
		      <th>&nbsp;</th>
		      <% if user_is_league_admin(current_user, @tournament.league) -%>
		      <th><%= link_to 'Add Game Type', new_league_tournament_tournament_day_scoring_rule_path(@tournament.league, @tournament, @tournament_day), class: 'btn btn-primary' %></th>
		      <% else -%>
		      <th>&nbsp;</th>
		      <% end -%>
		    </tr>
		  </thead>
		  <tbody>
		  <% @scoring_rules.each do |scoring_rule| %>
		    <tr>
		    	<td>
				    <% if scoring_rule.primary_rule %>
				      <strong>Primary</strong>
				    <% else %>
				      <%= link_to "Make Primary", league_tournament_tournament_day_scoring_rule_set_primary_path(@tournament.league, @tournament, @tournament_day, scoring_rule), data: { method: :put } %>
				    <% end %>
		    	</td>
		      <td><%= link_to scoring_rule.name, edit_league_tournament_tournament_day_scoring_rule_path(@tournament.league, @tournament, @tournament_day, scoring_rule) %></td>
		      <td>
		        <% if scoring_rule.show_course_holes? %>
		          <%= link_to "Setup Course Holes", edit_league_tournament_tournament_day_scoring_rule_course_holes_path(@tournament.league, @tournament, @tournament_day, scoring_rule) %>
		        <% else %>
		          N/A
		        <% end %>
		      </td>
		      <td>
		        <% if scoring_rule.payout_type == ScoringRulePayoutType::PREDETERMINED && scoring_rule.payout_assignment_type == ScoringRulePayoutAssignmentType::CALCULATED %>
		          <%= link_to "Configure Payouts (#{scoring_rule.payouts.count})", league_tournament_tournament_day_scoring_rule_payouts_path(@tournament.league, @tournament, @tournament_day, scoring_rule) %>
		        <% elsif scoring_rule.payout_assignment_type == ScoringRulePayoutAssignmentType::MANUAL %>
		          Manually Entered
		        <% else %>
		          Winners Split Pot
		        <% end %>
		        </td>
		      <% if user_is_league_admin(current_user, @tournament.league) %>
		      <td><%= link_to "Results", league_tournament_tournament_day_scoring_rule_payout_results_path(@tournament.league, @tournament, @tournament_day, scoring_rule) %> | <%= link_to "Edit", edit_league_tournament_tournament_day_scoring_rule_path(@tournament.league, @tournament, @tournament_day, scoring_rule) %> | <%= link_to 'Delete', league_tournament_tournament_day_scoring_rule_path(@tournament.league, @tournament, @tournament_day, scoring_rule), data: { confirm: 'Are you sure you want to delete this game type? That will also destroy any assigned results.' }, method: :delete %></td>
		      <% else -%>
		      <td>&nbsp;</td>
		      <% end -%>
		    </tr>
		  <% end %>
		  </tbody>
		  <tfoot>
		    <tr>
		    	<th>&nbsp;</th>
		      <th>&nbsp;</th>
		      <th>&nbsp;</th>
		      <th>&nbsp;</th>
		      <% if user_is_league_admin(current_user, @tournament.league) -%>
		      <th><%= link_to 'Add Game Type', new_league_tournament_tournament_day_scoring_rule_path(@tournament.league, @tournament, @tournament_day), class: 'btn btn-primary' %></th>
		      <% else -%>
		      <th>&nbsp;</th>
		      <% end -%>
		    </tr>
		  </tfoot>
		</table>
  </div>
</div>